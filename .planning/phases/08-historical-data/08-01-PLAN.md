---
phase: 08-historical-data
plan: 01
type: execute
depends_on: []
files_modified: [package.json, src/components/Charts/TrendChart.tsx, src/components/Charts/InflationChart.tsx, src/components/Charts/index.ts]
---

<objective>
Install Recharts and create reusable chart components for historical data visualization.

Purpose: Enable visual display of historical trends for metrics.
Output: Chart components ready to use in city detail pages.
</objective>

<context>
@src/types/metrics.ts (HistoricalDataPoint, InflationDataPoint)
@src/data/cities.json (sample historical data)

**Recharts:** Popular React charting library, works well with Next.js, supports:
- Line charts for trends
- Bar charts for inflation
- Responsive containers
- Tooltips and legends

**Chart requirements:**
- TrendChart: Line chart for salary/rent/property trends
- InflationChart: Bar chart for yearly inflation rates
- Consistent styling with app theme
- Responsive sizing
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Recharts</name>
  <files>package.json</files>
  <action>
Install Recharts library:

```bash
npm install recharts
```

Recharts is the recommended choice because:
- Declarative React components
- Built on D3, but simpler API
- Good TypeScript support
- Lightweight and performant
  </action>
  <verify>Package installed successfully</verify>
  <done>Recharts installed</done>
</task>

<task type="auto">
  <name>Task 2: Create TrendChart component</name>
  <files>src/components/Charts/TrendChart.tsx, src/components/Charts/index.ts</files>
  <action>
Create line chart component for trends:

1. Create directory: src/components/Charts/

2. Props interface:
   ```typescript
   interface TrendChartProps {
     data: HistoricalDataPoint[];
     title: string;
     color?: string;
     showUsd?: boolean; // Show USD or local values
     height?: number;
   }
   ```

3. Transform data for Recharts:
   ```typescript
   const chartData = data.map(point => ({
     year: point.year,
     value: showUsd ? point.value.usd : point.value.local,
   }));
   ```

4. Chart structure:
   ```tsx
   <div>
     <h4>{title}</h4>
     <ResponsiveContainer width="100%" height={height}>
       <LineChart data={chartData}>
         <CartesianGrid strokeDasharray="3 3" />
         <XAxis dataKey="year" />
         <YAxis />
         <Tooltip formatter={(val) => `$${val}`} />
         <Line
           type="monotone"
           dataKey="value"
           stroke={color}
           strokeWidth={2}
           dot={{ r: 4 }}
         />
       </LineChart>
     </ResponsiveContainer>
   </div>
   ```

5. Styling:
   - Default color: blue-600 (#2563eb)
   - Clean, minimal grid
   - Formatted tooltips
   - Responsive height

6. Mark as 'use client' (Recharts requires client-side rendering)

7. Create barrel export
  </action>
  <verify>TrendChart renders with sample data</verify>
  <done>TrendChart component created</done>
</task>

<task type="auto">
  <name>Task 3: Create InflationChart component</name>
  <files>src/components/Charts/InflationChart.tsx, src/components/Charts/index.ts</files>
  <action>
Create bar chart for inflation rates:

1. Props interface:
   ```typescript
   interface InflationChartProps {
     data: InflationDataPoint[];
     height?: number;
   }
   ```

2. Chart structure:
   ```tsx
   <ResponsiveContainer width="100%" height={height}>
     <BarChart data={data}>
       <CartesianGrid strokeDasharray="3 3" />
       <XAxis dataKey="year" />
       <YAxis unit="%" />
       <Tooltip formatter={(val) => `${val}%`} />
       <Bar
         dataKey="rate"
         fill="#f59e0b"
         radius={[4, 4, 0, 0]}
       />
     </BarChart>
   </ResponsiveContainer>
   ```

3. Color coding (optional):
   - High inflation (>5%): red/orange
   - Normal (<5%): amber
   - Low (<2%): green

4. Update barrel export
  </action>
  <verify>InflationChart renders with sample data</verify>
  <done>InflationChart component created</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds
- [ ] Recharts installed
- [ ] TrendChart component created
- [ ] InflationChart component created
- [ ] Components are client-side ('use client')
- [ ] No TypeScript errors
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Chart components ready for integration
</success_criteria>

<output>
After completion, create `.planning/phases/08-historical-data/08-01-SUMMARY.md`
</output>
