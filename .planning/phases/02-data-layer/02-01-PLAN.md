---
phase: 02-data-layer
plan: 01
type: execute
depends_on: []
files_modified: [src/types/city.ts, src/types/metrics.ts, src/types/index.ts]
---

<objective>
Define comprehensive TypeScript types for city data, metrics, and historical trends.

Purpose: Establish type-safe data contracts that all features will consume.
Output: Complete TypeScript type definitions for the entire data layer.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-01-SUMMARY.md

**Tech stack available:** Next.js 16.1.4, React 19.2.3, TypeScript 5, Tailwind 4
**Established patterns:** src/ directory structure, App Router

**Data requirements from PROJECT.md:**
- Metrics: salary, rent (1/2/3 bed), property prices, food, transport, utilities, internet, education, healthcare, entertainment
- Historical data with multi-year trends
- Dual currency display (local + USD)
- Initial cities: CIS + EU focus
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create core city types</name>
  <files>src/types/city.ts</files>
  <action>
Define TypeScript interfaces for city data:

1. `Currency` - code (ISO 4217), symbol, name
2. `Coordinates` - lat, lng for map positioning
3. `City` - core city data:
   - id: string (slug, e.g., "berlin", "moscow")
   - name: string
   - country: string
   - countryCode: string (ISO 3166-1 alpha-2)
   - region: "cis" | "eu" | "other"
   - coordinates: Coordinates
   - currency: Currency
   - population?: number
   - timezone?: string

Use `interface` for extensibility. Export all types. Add JSDoc comments for clarity.
  </action>
  <verify>npx tsc --noEmit passes without errors</verify>
  <done>City types defined with all required fields, TypeScript compiles</done>
</task>

<task type="auto">
  <name>Task 2: Create metrics types</name>
  <files>src/types/metrics.ts</files>
  <action>
Define TypeScript interfaces for all cost metrics:

1. `MoneyAmount` - value in local currency + USD equivalent:
   - local: number
   - usd: number

2. `RentMetrics` - monthly rent costs:
   - studio?: MoneyAmount
   - oneBedroom: MoneyAmount
   - twoBedroom: MoneyAmount
   - threeBedroom: MoneyAmount

3. `PropertyMetrics` - real estate prices per sqm:
   - cityCenter: MoneyAmount
   - outside: MoneyAmount

4. `FoodMetrics` - monthly food costs:
   - groceries: MoneyAmount (avg monthly basket)
   - restaurantMeal: MoneyAmount (mid-range, per meal)
   - fastFood: MoneyAmount (per meal)

5. `TransportMetrics`:
   - monthlyPass: MoneyAmount
   - taxiPerKm: MoneyAmount
   - gasoline: MoneyAmount (per liter)

6. `UtilitiesMetrics` - monthly for 85sqm apartment:
   - basic: MoneyAmount (electricity, heating, water, garbage)
   - internet: MoneyAmount
   - mobile: MoneyAmount (monthly plan)

7. `LifestyleMetrics`:
   - gymMembership: MoneyAmount (monthly)
   - cinema: MoneyAmount (ticket)
   - cappuccino: MoneyAmount

8. `EducationMetrics`:
   - preschool?: MoneyAmount (monthly)
   - internationalSchool?: MoneyAmount (yearly)

9. `HealthcareMetrics`:
   - doctorVisit: MoneyAmount
   - medicationBasic: MoneyAmount (monthly avg)

10. `SalaryMetrics`:
    - average: MoneyAmount (monthly net)
    - median?: MoneyAmount (monthly net)
    - minimum?: MoneyAmount (monthly net)

11. `CityMetrics` - combines all metric categories:
    - salary: SalaryMetrics
    - rent: RentMetrics
    - property: PropertyMetrics
    - food: FoodMetrics
    - transport: TransportMetrics
    - utilities: UtilitiesMetrics
    - lifestyle: LifestyleMetrics
    - education?: EducationMetrics
    - healthcare: HealthcareMetrics
    - updatedAt: string (ISO date)
    - sources?: string[] (data source attribution)

All MoneyAmount fields allow partial data (some cities won't have all metrics).
  </action>
  <verify>npx tsc --noEmit passes without errors</verify>
  <done>All metric types defined covering salary, rent, property, food, transport, utilities, lifestyle, education, healthcare</done>
</task>

<task type="auto">
  <name>Task 3: Create historical and aggregate types</name>
  <files>src/types/metrics.ts, src/types/city.ts, src/types/index.ts</files>
  <action>
Add historical data types to metrics.ts:

1. `HistoricalDataPoint`:
   - year: number
   - value: MoneyAmount

2. `HistoricalMetrics` - yearly snapshots for key metrics:
   - averageSalary?: HistoricalDataPoint[]
   - rentOneBedroom?: HistoricalDataPoint[]
   - propertyPrice?: HistoricalDataPoint[]
   - inflation?: { year: number; rate: number }[]

Add to city.ts:

3. `CityWithMetrics` - extends City with current metrics:
   - All City fields
   - metrics: CityMetrics
   - historical?: HistoricalMetrics

4. `CityIndex` - lightweight city reference for lists/maps:
   - id: string
   - name: string
   - country: string
   - region: string
   - coordinates: Coordinates

Create index.ts barrel export:
- Export all types from city.ts and metrics.ts
- Single import point: `import { City, CityMetrics, ... } from '@/types'`
  </action>
  <verify>npx tsc --noEmit passes, import from '@/types' works</verify>
  <done>Historical types defined, CityWithMetrics combines city + metrics, barrel export created</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes without errors
- [ ] All interfaces documented with JSDoc
- [ ] Types cover all metrics from PROJECT.md requirements
- [ ] Barrel export from `@/types` works
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Types are comprehensive but not over-engineered
- Ready for data loading utilities in Plan 02-02
</success_criteria>

<output>
After completion, create `.planning/phases/02-data-layer/02-01-SUMMARY.md`
</output>
